<form class="form-container" autocomplete="off" [empNgSpinnerHost]="spinner" [formGroup]="form">

  <emp-ng-spinner #spinner [visible]="isLoading"></emp-ng-spinner>

  <fieldset>

    <table class="form-section">
      <tr>
        <td class="form-section-title" colspan="2" i18n>Associated data source</td>
      </tr>
      <tr>
        <td i18n>Family:</td>
        <td>
          <select class="select-box" style="width:380px" formControlName="dataSourceFamily" (change)="updateUIControls()">
            <option value="" i18n>All families</option>
            <option *ngFor="let family of dataSourceFamilies" [value]="family">{{family}}</option>
          </select>
        </td>
      </tr>
      <tr>
        <td i18n>Type:</td>
        <td>
          <select class="select-box" style="width:380px" formControlName="dataSourceType"
                  (change)="updateUIControls()">
            <option value="">All data source types</option>
            <option value="">--- Fill out ---</option>
            <option value="DataSource.AutogeneratedExcelFile" i18n>Autogenerated Excel file</option>
            <option value="DataSource.ExcelTemplateFillOut" i18n>Excel template file fill out</option>
            <option value="DataSource.PDFFormFillOut" i18n>PDF Form fill out</option>
            <option value="DataSource.WebFormFillOut" i18n>Web Form fill out</option>
            <option value="">--- File attachment ---</option>
            <option value="DataSource.AttachADataFile" i18n>Attach a data file</option>
            <option value="DataSource.AttachADataFileReference" i18n>Attach a data file reference (for large files)</option>
            <option value="DataSource.GenerateFilesFolderStructure" i18n>Generate a folder structure with files</option>
            <option value="">--- Includes ---</option>
            <option value="DataSource.IncludeADocumentReferenceFromAnotherActivity" i18n>Include a document reference from another activity</option>
            <option value="DataSource.GetADocumentCopyFromAnotherActivity" i18n>Get a document copy from another activity</option>
            <option value="">--- External and third-party databases ---</option>
            <option value="DataSource.GetDataFromAnExternalDatabase" i18n>Get data from an external database</option>
            <option value="DataSource.ExportDataToAnExternalDatabase" i18n>Export data to an external database</option>
          </select>
        </td>
      </tr>
      <tr>
        <td i18n>Name:</td>
        <td>
          <select class="select-box" style="width:100%" formControlName="dataSource" (change)="selectDataSource()">
            <option value="" i18n>( Select a data source )</option>
            <option *ngFor="let dataSource of filteredDataSources" [value]="dataSource.uid">{{dataSource.name}}</option>
          </select>
        </td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>
          <a *ngIf="selectedDataSource" [href]="selectedDataSource?.templateUrl" target="_base">View template file</a>
        </td>
      </tr>
      <tr>
        <td i18n>Description:</td>
        <td>
          <textarea class="text-area" rows="3" cols="25" readonly="readonly"
                    [value]="selectedDataSource?.description"></textarea>
        </td>
      </tr>
    </table>

    <table class="form-section">
      <tr>
        <td>&nbsp;</td>
        <td class="text-align-right">
          <button type="button" class="btn right" [class.btn-action]="isValidForm"
                  [disabled]="!isValidForm" (click)="linkDataSource()">Add to obligation</button>
        </td>
      </tr>
    </table>

  </fieldset>

</form>
