<div class="activity-tree-container" *ngIf="filter.project.uid !== ''">

  <div class="activity-tree-header">
    <button class="btn-warning" (click)="showInitialActivityInlineEditor()">Nueva</button>
    <span *ngIf="filter.project.name">Proyecto: {{filter.project.name}}</span>
  </div>

  <div class="activity-tree-body">

    <div *ngIf="(addFirstActivityEditorVisible && !hasSelectedActivities)" class="activity-inline-editor">
        <input #txtActivityName type="text"
               class="text-box" style="width:80%"
               (keyup.esc)="hideInlineEditors()"
               (keyup.enter)="insertActivity(txtActivityName.value)"
               placeholder= "Nombre de la actividad">
        <button class="btn" (click)="hideInlineEditors()">Cancelar</button>
    </div>

    <div *ngFor="let activity of activityTree" class="activity-row" (click)="selectActivity(activity)">

      <div [class.selected-activity]="isActivitySelected(activity)"
            draggable="true"
            (dragover)="allowDrop($event)"
            (dragstart)="drag($event, activity)"
            (drop)="moveActivity($event, activity.position)">

          <div class="activity-position-controls">
            <i class="fa fa-align-justify ghost-icon grabbable" aria-hidden="true" (click)="startDrag(activity)"></i>
          </div>

          <div class="activity-name">
           
            <div (dragover)="allowDrop($event)"
              (drop)="moveActivityAsChildOf($event, activity)">

              <a [ngClass]="activityNameClass(activity.level)"
               [style.padding-left.pt]="activity.level * 14"
               (click)="selectActivity(activity, true)">{{activity.name}}</a>

            </div>
          </div>

          <div class="activity-menu">
            <a (click)="displayMenu(activity)">
              <i class="fa fa-ellipsis-v ghost-icon"></i>
            </a>
          </div>

      </div>

      <div *ngIf="isActivitySelected(activity)" class="activity-inline-editor">

        <div *ngIf="insertActivityEditorVisible">
          <input #txtActivityName type="text"
                 class="text-box" style="width:80%"
                 [style.margin-left.pt]="activity.level * 14"
                 placeholder= "Nombre de la actividad"
                 (keyup.esc)="hideInlineEditors()"
                 (keyup.enter)="insertActivity(txtActivityName.value, activity.position)">
          <button class="btn" (click)="hideInlineEditors()">Cancelar</button>
        </div>

      </div>

    </div>
  
    <div class="activity-row"        
        (dragover)="allowDrop($event)"
        (drop)="moveActivity($event, activityTree.length + 1)">
    </div>

  </div>

</div>
